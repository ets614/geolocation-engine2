name: Discord Notifications

on:
  issues:
    types: [opened, labeled, closed]
  pull_request:
    types: [opened, ready_for_review, review_requested, synchronize]

jobs:
  notify-discord:
    name: Send Discord Notification
    runs-on: ubuntu-latest
    env:
      WEBHOOK_URL: ${{ secrets.DISCORD_WEBHOOK_URL }}
    steps:
      - name: Discord notification - Issue opened
        if: github.event_name == 'issues' && github.event.action == 'opened' && env.WEBHOOK_URL != ''
        run: |
          curl -X POST "$WEBHOOK_URL" \
            -H 'Content-Type: application/json' \
            -d '{
              "embeds": [{
                "title": "üìã New Issue Created",
                "description": "${{ github.event.issue.title }}",
                "url": "${{ github.event.issue.html_url }}",
                "color": 3447003,
                "fields": [
                  {"name": "Issue #", "value": "${{ github.event.issue.number }}", "inline": true},
                  {"name": "Author", "value": "${{ github.event.issue.user.login }}", "inline": true}
                ]
              }]
            }'

      - name: Discord notification - Issue labeled
        if: github.event_name == 'issues' && github.event.action == 'labeled' && env.WEBHOOK_URL != ''
        run: |
          curl -X POST "$WEBHOOK_URL" \
            -H 'Content-Type: application/json' \
            -d '{
              "embeds": [{
                "title": "üè∑Ô∏è Issue Labeled",
                "description": "${{ github.event.issue.title }}",
                "url": "${{ github.event.issue.html_url }}",
                "color": 15158332,
                "fields": [
                  {"name": "Issue #", "value": "${{ github.event.issue.number }}", "inline": true}
                ]
              }]
            }'

      - name: Discord notification - Issue closed
        if: github.event_name == 'issues' && github.event.action == 'closed' && env.WEBHOOK_URL != ''
        run: |
          curl -X POST "$WEBHOOK_URL" \
            -H 'Content-Type: application/json' \
            -d '{
              "embeds": [{
                "title": "‚úÖ Issue Closed",
                "description": "${{ github.event.issue.title }}",
                "url": "${{ github.event.issue.html_url }}",
                "color": 3066993
              }]
            }'

      - name: Discord notification - PR opened
        if: github.event_name == 'pull_request' && github.event.action == 'opened' && env.WEBHOOK_URL != ''
        run: |
          curl -X POST "$WEBHOOK_URL" \
            -H 'Content-Type: application/json' \
            -d '{
              "embeds": [{
                "title": "üöÄ Pull Request Opened",
                "description": "${{ github.event.pull_request.title }}",
                "url": "${{ github.event.pull_request.html_url }}",
                "color": 9437184,
                "fields": [
                  {"name": "PR #", "value": "${{ github.event.pull_request.number }}", "inline": true},
                  {"name": "Author", "value": "${{ github.event.pull_request.user.login }}", "inline": true}
                ]
              }]
            }'

      - name: Discord notification - PR ready for review
        if: github.event_name == 'pull_request' && github.event.action == 'ready_for_review' && env.WEBHOOK_URL != ''
        run: |
          curl -X POST "$WEBHOOK_URL" \
            -H 'Content-Type: application/json' \
            -d '{
              "embeds": [{
                "title": "üëÄ PR Ready for Review",
                "description": "${{ github.event.pull_request.title }}",
                "url": "${{ github.event.pull_request.html_url }}",
                "color": 16776960,
                "fields": [
                  {"name": "PR #", "value": "${{ github.event.pull_request.number }}", "inline": true}
                ]
              }]
            }'
